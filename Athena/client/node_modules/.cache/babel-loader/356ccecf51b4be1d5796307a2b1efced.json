{"ast":null,"code":"/*!\n * ws: a node.js websocket client\n * Copyright(c) 2011 Einar Otto Stangvik <einaros@gmail.com>\n * MIT Licensed\n */\nvar util = require('util');\n\nfunction BufferPool(initialSize, growStrategy, shrinkStrategy) {\n  if (this instanceof BufferPool === false) {\n    throw new TypeError(\"Classes can't be function-called\");\n  }\n\n  if (typeof initialSize === 'function') {\n    shrinkStrategy = growStrategy;\n    growStrategy = initialSize;\n    initialSize = 0;\n  } else if (typeof initialSize === 'undefined') {\n    initialSize = 0;\n  }\n\n  this._growStrategy = (growStrategy || function (db, size) {\n    return db.used + size;\n  }).bind(null, this);\n\n  this._shrinkStrategy = (shrinkStrategy || function (db) {\n    return initialSize;\n  }).bind(null, this);\n\n  this._buffer = initialSize ? new Buffer(initialSize) : null;\n  this._offset = 0;\n  this._used = 0;\n  this._changeFactor = 0;\n\n  this.__defineGetter__('size', function () {\n    return this._buffer == null ? 0 : this._buffer.length;\n  });\n\n  this.__defineGetter__('used', function () {\n    return this._used;\n  });\n}\n\nBufferPool.prototype.get = function (length) {\n  if (this._buffer == null || this._offset + length > this._buffer.length) {\n    var newBuf = new Buffer(this._growStrategy(length));\n    this._buffer = newBuf;\n    this._offset = 0;\n  }\n\n  this._used += length;\n\n  var buf = this._buffer.slice(this._offset, this._offset + length);\n\n  this._offset += length;\n  return buf;\n};\n\nBufferPool.prototype.reset = function (forceNewBuffer) {\n  var len = this._shrinkStrategy();\n\n  if (len < this.size) this._changeFactor -= 1;\n\n  if (forceNewBuffer || this._changeFactor < -2) {\n    this._changeFactor = 0;\n    this._buffer = len ? new Buffer(len) : null;\n  }\n\n  this._offset = 0;\n  this._used = 0;\n};\n\nmodule.exports = BufferPool;","map":{"version":3,"sources":["/home/subho/Programming/Internet-Technology/Athena/node_modules/ws/lib/BufferPool.js"],"names":["util","require","BufferPool","initialSize","growStrategy","shrinkStrategy","TypeError","_growStrategy","db","size","used","bind","_shrinkStrategy","_buffer","Buffer","_offset","_used","_changeFactor","__defineGetter__","length","prototype","get","newBuf","buf","slice","reset","forceNewBuffer","len","module","exports"],"mappings":"AAAA;AACA;AACA;AACA;AACA;AAEA,IAAIA,IAAI,GAAGC,OAAO,CAAC,MAAD,CAAlB;;AAEA,SAASC,UAAT,CAAoBC,WAApB,EAAiCC,YAAjC,EAA+CC,cAA/C,EAA+D;AAC7D,MAAI,gBAAgBH,UAAhB,KAA+B,KAAnC,EAA0C;AACxC,UAAM,IAAII,SAAJ,CAAc,kCAAd,CAAN;AACD;;AAED,MAAI,OAAOH,WAAP,KAAuB,UAA3B,EAAuC;AACrCE,IAAAA,cAAc,GAAGD,YAAjB;AACAA,IAAAA,YAAY,GAAGD,WAAf;AACAA,IAAAA,WAAW,GAAG,CAAd;AACD,GAJD,MAKK,IAAI,OAAOA,WAAP,KAAuB,WAA3B,EAAwC;AAC3CA,IAAAA,WAAW,GAAG,CAAd;AACD;;AACD,OAAKI,aAAL,GAAqB,CAACH,YAAY,IAAI,UAASI,EAAT,EAAaC,IAAb,EAAmB;AACvD,WAAOD,EAAE,CAACE,IAAH,GAAUD,IAAjB;AACD,GAFoB,EAElBE,IAFkB,CAEb,IAFa,EAEP,IAFO,CAArB;;AAGA,OAAKC,eAAL,GAAuB,CAACP,cAAc,IAAI,UAASG,EAAT,EAAa;AACrD,WAAOL,WAAP;AACD,GAFsB,EAEpBQ,IAFoB,CAEf,IAFe,EAET,IAFS,CAAvB;;AAGA,OAAKE,OAAL,GAAeV,WAAW,GAAG,IAAIW,MAAJ,CAAWX,WAAX,CAAH,GAA6B,IAAvD;AACA,OAAKY,OAAL,GAAe,CAAf;AACA,OAAKC,KAAL,GAAa,CAAb;AACA,OAAKC,aAAL,GAAqB,CAArB;;AACA,OAAKC,gBAAL,CAAsB,MAAtB,EAA8B,YAAU;AACtC,WAAO,KAAKL,OAAL,IAAgB,IAAhB,GAAuB,CAAvB,GAA2B,KAAKA,OAAL,CAAaM,MAA/C;AACD,GAFD;;AAGA,OAAKD,gBAAL,CAAsB,MAAtB,EAA8B,YAAU;AACtC,WAAO,KAAKF,KAAZ;AACD,GAFD;AAGD;;AAEDd,UAAU,CAACkB,SAAX,CAAqBC,GAArB,GAA2B,UAASF,MAAT,EAAiB;AAC1C,MAAI,KAAKN,OAAL,IAAgB,IAAhB,IAAwB,KAAKE,OAAL,GAAeI,MAAf,GAAwB,KAAKN,OAAL,CAAaM,MAAjE,EAAyE;AACvE,QAAIG,MAAM,GAAG,IAAIR,MAAJ,CAAW,KAAKP,aAAL,CAAmBY,MAAnB,CAAX,CAAb;AACA,SAAKN,OAAL,GAAeS,MAAf;AACA,SAAKP,OAAL,GAAe,CAAf;AACD;;AACD,OAAKC,KAAL,IAAcG,MAAd;;AACA,MAAII,GAAG,GAAG,KAAKV,OAAL,CAAaW,KAAb,CAAmB,KAAKT,OAAxB,EAAiC,KAAKA,OAAL,GAAeI,MAAhD,CAAV;;AACA,OAAKJ,OAAL,IAAgBI,MAAhB;AACA,SAAOI,GAAP;AACD,CAVD;;AAYArB,UAAU,CAACkB,SAAX,CAAqBK,KAArB,GAA6B,UAASC,cAAT,EAAyB;AACpD,MAAIC,GAAG,GAAG,KAAKf,eAAL,EAAV;;AACA,MAAIe,GAAG,GAAG,KAAKlB,IAAf,EAAqB,KAAKQ,aAAL,IAAsB,CAAtB;;AACrB,MAAIS,cAAc,IAAI,KAAKT,aAAL,GAAqB,CAAC,CAA5C,EAA+C;AAC7C,SAAKA,aAAL,GAAqB,CAArB;AACA,SAAKJ,OAAL,GAAec,GAAG,GAAG,IAAIb,MAAJ,CAAWa,GAAX,CAAH,GAAqB,IAAvC;AACD;;AACD,OAAKZ,OAAL,GAAe,CAAf;AACA,OAAKC,KAAL,GAAa,CAAb;AACD,CATD;;AAWAY,MAAM,CAACC,OAAP,GAAiB3B,UAAjB","sourcesContent":["/*!\n * ws: a node.js websocket client\n * Copyright(c) 2011 Einar Otto Stangvik <einaros@gmail.com>\n * MIT Licensed\n */\n\nvar util = require('util');\n\nfunction BufferPool(initialSize, growStrategy, shrinkStrategy) {\n  if (this instanceof BufferPool === false) {\n    throw new TypeError(\"Classes can't be function-called\");\n  }\n\n  if (typeof initialSize === 'function') {\n    shrinkStrategy = growStrategy;\n    growStrategy = initialSize;\n    initialSize = 0;\n  }\n  else if (typeof initialSize === 'undefined') {\n    initialSize = 0;\n  }\n  this._growStrategy = (growStrategy || function(db, size) {\n    return db.used + size;\n  }).bind(null, this);\n  this._shrinkStrategy = (shrinkStrategy || function(db) {\n    return initialSize;\n  }).bind(null, this);\n  this._buffer = initialSize ? new Buffer(initialSize) : null;\n  this._offset = 0;\n  this._used = 0;\n  this._changeFactor = 0;\n  this.__defineGetter__('size', function(){\n    return this._buffer == null ? 0 : this._buffer.length;\n  });\n  this.__defineGetter__('used', function(){\n    return this._used;\n  });\n}\n\nBufferPool.prototype.get = function(length) {\n  if (this._buffer == null || this._offset + length > this._buffer.length) {\n    var newBuf = new Buffer(this._growStrategy(length));\n    this._buffer = newBuf;\n    this._offset = 0;\n  }\n  this._used += length;\n  var buf = this._buffer.slice(this._offset, this._offset + length);\n  this._offset += length;\n  return buf;\n}\n\nBufferPool.prototype.reset = function(forceNewBuffer) {\n  var len = this._shrinkStrategy();\n  if (len < this.size) this._changeFactor -= 1;\n  if (forceNewBuffer || this._changeFactor < -2) {\n    this._changeFactor = 0;\n    this._buffer = len ? new Buffer(len) : null;\n  }\n  this._offset = 0;\n  this._used = 0;\n}\n\nmodule.exports = BufferPool;\n"]},"metadata":{},"sourceType":"script"}