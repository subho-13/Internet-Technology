(this["webpackJsonpathena-client"]=this["webpackJsonpathena-client"]||[]).push([[0],{52:function(e,t,n){},54:function(e,t,n){},55:function(e,t,n){},56:function(e,t,n){},57:function(e,t,n){},58:function(e,t,n){},59:function(e,t,n){},97:function(e,t,n){"use strict";n.r(t);var s=n(46),r=n.n(s),a=n(2),o=n(3),c=n(5),i=n(4),u=n(1),l=n.n(u),m=n(99),h=(n(52),n(13)),p=Object(h.a)(),j=n(0),d=function(e){Object(c.a)(n,e);var t=Object(i.a)(n);function n(){var e;return Object(a.a)(this,n),(e=t.call(this)).handleSubmit=function(t){t.preventDefault(),e.props.onSubmit(e.state.username),socket.emit("join",e.state.username),p.push("/Chat")},e.handleUsernameChange=function(t){e.setState({username:t.target.value})},e.handleUsernameClick=function(){e.setState({username:""})},e.state={username:"name"},e}return Object(o.a)(n,[{key:"render",value:function(){return Object(j.jsx)("div",{className:"login-container",children:Object(j.jsxs)("form",{onSubmit:this.handleSubmit,className:"login-form",children:[Object(j.jsxs)("div",{className:"login-username",children:[Object(j.jsx)("label",{htmlFor:"username",children:"USERNAME"}),Object(j.jsx)("input",{type:"text",id:"username",name:"username",value:this.state.username,onClick:this.handleUsernameClick,onChange:this.handleUsernameChange})]}),Object(j.jsx)("div",{className:"login-join",children:Object(j.jsx)("input",{type:"submit",value:"JOIN"})})]})})}}]),n}(u.Component),b=n(15),f=(n(54),function(e){Object(c.a)(n,e);var t=Object(i.a)(n);function n(){var e;return Object(a.a)(this,n),(e=t.call(this)).handleUsername=function(t){e.setState({username:t.target.value})},e.handleAdd=function(t){e.setState({showform:t})},e.handleClick=function(){e.setState({username:""})},e.handleSubmitFriend=function(t){t.preventDefault(),e.props.handleUser(e.state.username,"friend"),e.setState({showform:"none"})},e.getFriendForm=function(){return Object(j.jsxs)("form",{onSubmit:e.handleSubmitFriend,className:"header-form",children:[Object(j.jsx)("input",{type:"text",name:"username",value:e.state.username,onChange:e.handleUsername,onClick:e.handleClick,className:"header-user"}),Object(j.jsx)("input",{type:"submit",value:"Add",className:"header-join"})]})},e.handleSubmitGroup=function(t){t.preventDefault(),e.props.handleUser(e.state.username,"group"),e.setState({showform:"none"})},e.getGroupForm=function(){return Object(j.jsxs)("form",{onSubmit:e.handleSubmitGroup,className:"header-form",children:[Object(j.jsx)("input",{type:"text",name:"username",value:e.state.username,onChange:e.handleUsername,onClick:e.handleClick,className:"header-user"}),Object(j.jsx)("input",{type:"submit",value:"Join",className:"header-join"})]})},e.state={showform:"none",username:"username"},e}return Object(o.a)(n,[{key:"render",value:function(){var e,t=this;return"group"===this.state.showform?e=this.getGroupForm():"friend"===this.state.showform&&(e=this.getFriendForm()),Object(j.jsxs)("div",{className:"header-section",children:[e,Object(j.jsx)("button",{onClick:function(){return t.handleAdd("friend")},className:"friend",children:"Friend"}),Object(j.jsx)("button",{onClick:function(){return t.handleAdd("group")},className:"group",children:"Group"}),Object(j.jsx)("button",{onClick:this.props.handleLogout,className:"logout",children:"Logout"}),Object(j.jsx)("div",{children:this.props.username})]})}}]),n}(u.Component)),O=function(e){Object(c.a)(n,e);var t=Object(i.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(o.a)(n,[{key:"render",value:function(){var e=this;return Object(j.jsxs)("div",{children:[Object(j.jsx)("button",{onClick:function(){return e.props.onDisplay(e.props.receiver)},children:this.props.receiver.username}),Object(j.jsx)("button",{onClick:function(){return e.props.onDelete(e.props.receiver)},children:"D"})]})}}]),n}(u.Component),v=(n(55),function(e){Object(c.a)(n,e);var t=Object(i.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(o.a)(n,[{key:"render",value:function(){var e=this;return Object(j.jsx)("div",{className:"chatlist",children:Object(b.a)(this.props.receivers).map((function(t){return Object(j.jsx)(O,{receiver:{username:t[0],type:t[1]},onDelete:e.props.onDelete,onDisplay:e.props.onDisplay},t[0])}))})}}]),n}(u.Component)),g=(n(56),n(57),function(){function e(){Object(a.a)(this,e)}return Object(o.a)(e,null,[{key:"imageContent",value:function(e,t){return Object(j.jsx)("img",{className:t,src:e,alt:"image"})}},{key:"textContent",value:function(e,t){return Object(j.jsx)("p",{className:t,children:e})}}]),e}()),x=function(e){Object(c.a)(n,e);var t=Object(i.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(o.a)(n,[{key:"render",value:function(){var e="personal-message-"+this.props.owner;return"text"===this.props.type?g.textContent(this.props.content,e+"-text"):"image"===this.props.type?g.imageContent(this.props.content,e+"-image"):void 0}}]),n}(u.Component),y=function(e){Object(c.a)(n,e);var t=Object(i.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(o.a)(n,[{key:"render",value:function(){var e,t,n="group-message-";return"self"!==this.props.owner?(e=Object(j.jsx)("p",{className:"group-message-header",children:this.props.owner}),n+="other"):n+="self","text"===this.props.content?t=g.textContent(this.props.content,n+"-text"):"image"===this.props.content&&(t=g.imageContent(this.props.content,n+"-image")),Object(j.jsxs)("div",{children:[e,t]})}}]),n}(u.Component),k=(n(58),function(e){Object(c.a)(n,e);var t=Object(i.a)(n);function n(e){var s;return Object(a.a)(this,n),(s=t.call(this,e)).groupMessages=function(e){return e.map((function(e){var t;return t=e.from===s.username?"self":e.from,Object(j.jsx)(y,{owner:t,type:e.type,content:e.content})}))},s.personalMessages=function(e){return e.map((function(e){var t;return t=e.from===s.username?"self":"other",Object(j.jsx)(x,{owner:t,type:e.type,content:e.content})}))},s.executeScroll=function(){return s.myRef.current.scrollIntoView()},s.username=s.props.username,s.endref=l.a.createRef(),s}return Object(o.a)(n,[{key:"componentDidUpdate",value:function(){this.endref.current.scrollIntoView({behaviour:"smooth"})}},{key:"render",value:function(){var e;return e="group"===this.props.type?this.groupMessages:this.personalMessages,console.log(this.props.messages),Object(j.jsxs)("div",{className:"display",children:[Object(j.jsx)("div",{className:"display-header",children:Object(j.jsx)("h",{children:this.props.name})}),Object(j.jsxs)("div",{className:"overflow",children:[Object(j.jsx)("div",{className:"display-messages",children:e(this.props.messages)}),Object(j.jsx)("div",{ref:this.endref})]})]})}}]),n}(u.Component)),C=(n(59),function(e){Object(c.a)(n,e);var t=Object(i.a)(n);function n(){var e;return Object(a.a)(this,n),(e=t.call(this)).onSubmit=function(t){t.preventDefault(),e.props.handleSend({type:e.state.type,content:e.state.content})},e.handleOptionClick=function(){"text"===e.state.type?e.setState({type:"image",optionButtonName:"Image"}):e.setState({type:"text",optionButtonName:"Text"})},e.handleTextContent=function(t){e.setState({content:t.target.value})},e.getTextForm=function(){return Object(j.jsxs)("form",{onSubmit:e.onSubmit,className:"sendbar-form",children:[Object(j.jsx)("input",{type:"text",name:"image",onChange:e.handleTextContent,className:"sendbar-text"}),Object(j.jsx)("input",{type:"submit",value:"Send",className:"sendbar-send-button"})]})},e.handleImageFile=function(t){var n=new FileReader;n.onloadend=function(){e.setState({content:n.result})},n.readAsDataURL(t.target.files[0])},e.getImgForm=function(){return Object(j.jsxs)("form",{onSubmit:e.onSubmit,className:"sendbar-form",children:[Object(j.jsxs)("label",{className:"sendbar-image",children:["Upload",Object(j.jsx)("input",{type:"file",name:"image",onChange:e.handleImageFile})]}),Object(j.jsx)("input",{type:"submit",value:"Send",className:"sendbar-send-button"})]})},e.state={type:"text",content:"",optionButtonName:"Text"},e}return Object(o.a)(n,[{key:"render",value:function(){var e;return"text"===this.state.type?e=this.getTextForm():"image"===this.state.type&&(e=this.getImgForm()),Object(j.jsxs)("div",{className:"sendbar",children:[Object(j.jsx)("button",{onClick:this.handleOptionClick,className:"sendbar-option-button",children:this.state.optionButtonName}),e]})}}]),n}(u.Component)),S=function(e){Object(c.a)(n,e);var t=Object(i.a)(n);function n(e){var s;return Object(a.a)(this,n),(s=t.call(this,e)).handleDelete=function(e){var t=s.state.receiverlist;t.delete(e.username),s.setState({receiverlist:t}),s.props.socket.emit("leave",e.username)},s.handleDisplay=function(e){console.log(e),s.setState({receiver:e}),s.storage.has(e.username)?s.setState({currentMessages:s.storage.get(e.username)}):s.setState({currentMessages:[]})},s.handleLogout=function(){console.log(s.username),s.props.socket.emit("leave",s.username),p.push("/")},s.handleUser=function(e,t){!1===s.state.receiverlist.has(e)&&s.setState((function(n){return{receiverlist:n.receiverlist.set(e,t)}})),t===group&&s.props.socket.emit("join",e)},s.handleSend=function(e){var t=s.state.receiver.username,n={from:s.username,to:t,type:e.type,content:e.content};s.setState({currentMessages:[].concat(Object(b.a)(s.state.currentMessages),[n])}),s.storage.has(t)?s.storage.set(t,[].concat(Object(b.a)(s.storage.get(t)),[n])):s.storage.set(t,[n]),s.props.socket.emit("send",n)},s.storage=new Map,s.state={receiverlist:new Map,receiver:{username:"",type:""},currentMessages:[]},s.username=s.props.username,s.props.socket.on("receive",(function(e){console.log(e),e.from===s.receiver.username&&s.setState({currentMessages:[].concat(Object(b.a)(s.state.currentMessages),[e])}),s.storage.has(e.from)?s.storage.set(e.from,[].concat(Object(b.a)(s.storage.get(e.from)),[e])):s.storage.set(e.from,[e])})),s}return Object(o.a)(n,[{key:"render",value:function(){var e,t;return""!==this.state.receiver.username&&(e=Object(j.jsx)(C,{handleSend:this.handleSend,className:"sendbar"}),t=Object(j.jsx)(k,{username:this.username,name:this.state.receiver.username,messages:this.state.currentMessages})),Object(j.jsxs)("div",{className:"chat-container",children:[Object(j.jsx)(f,{username:this.username,handleUser:this.handleUser,handleLogout:this.handleLogout}),Object(j.jsxs)("div",{className:"section-2",children:[Object(j.jsx)(v,{receivers:this.state.receiverlist,onDelete:this.handleDelete,onDisplay:this.handleDisplay}),t,e]})]})}}]),n}(u.Component),N=function(e){Object(c.a)(n,e);var t=Object(i.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(o.a)(n,[{key:"render",value:function(){var e=this;return console.log(this.props.socket),Object(j.jsx)(m.b,{history:p,children:Object(j.jsxs)(m.c,{children:[Object(j.jsx)(m.a,{exact:!0,path:"/",render:function(){return Object(j.jsx)(d,{socket:e.props.socket,onSubmit:e.props.handleUsername})}}),Object(j.jsx)(m.a,{path:"/Chat",render:function(){return Object(j.jsx)(S,{socket:e.props.socket,username:e.props.username})}})]})})}}]),n}(u.Component),w=n(22),D=n.n(w),F=Object(w.io)(),U=(u.Component,function(e){Object(c.a)(n,e);var t=Object(i.a)(n);function n(){var e;return Object(a.a)(this,n),(e=t.call(this)).socket=D()("localhost:8080"),console.log(e.socket),e}return Object(o.a)(n,[{key:"render",value:function(){return Object(j.jsx)("div",{children:"Hi"})}}]),n}(u.Component));r.a.render(Object(j.jsx)(U,{}),document.getElementById("root"))}},[[97,1,2]]]);
//# sourceMappingURL=main.a001f274.chunk.js.map